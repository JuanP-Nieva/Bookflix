@model IEnumerable<Bookflix.Models.Libro>

@{
    ViewData["Title"] = "Index";
}

<h1 style="color: #E50914 ;">LIBROS</h1>

<div>
    <form asp-controller="Libro" asp-action="Index" >
        <div class="btn-group btn-group-toggle" data-toggle="buttons">
            <label class="btn btn-secondary active">
                <input type="radio" name="options" value="BuscarTitulo" asp-action="Libro" asp-action="Index" checked> Buscar Titulo
            </label>
            <label class="btn btn-secondary">
                <input type="radio" name="options" value="BuscarAutor" asp-action="Libro" asp-action="Index"> Buscar Autor
            </label>
            <label class="btn btn-secondary">
                <input type="radio" name="options" value="BuscarGenero" asp-action="Libro" asp-action="Index"> Buscar Genero
            </label>
            <label class="btn btn-secondary">
                <input type="radio" name="options" value="BuscarEditorial" asp-action="Libro" asp-action="Index"> Buscar Editorial
            </label>
        </div>
        <hr>
        <input type="text" name="SearchString" placeholder="Buscar">
        <input class="btn btn-primary btn-sm" type="submit" value="Buscar" />
    </form>
</div>
@if(User.IsInRole("Administrador")){
    <br>
    <p>
        <a class="btn btn-danger" asp-action="Create" role="button">Crear Libro</a>
        @*ESTO NO ESTABA, es para crear libros con capitulos*@
        <a class="btn btn-danger" asp-action="CreateConCapitulos" role="button">Crear Libro Completo</a>
    </p>
}
<table class="table">
    <thead>
        <tr>
            @* <th>
                <a style="color: white;">@Html.DisplayNameFor(model => model.ISBN) </a>
            </th> *@
            <th>
                <a style="color: white;">@Html.DisplayNameFor(model => model.Portada) </a>
            </th>
            <th>
                <a style="color: white;">@Html.DisplayNameFor(model => model.Titulo) </a>
            </th>
            @* <th>
                <a style="color: white;">@Html.DisplayNameFor(model => model.Contenido) </a>
            </th> *@
            <th>
                <a style="color: white;">@Html.DisplayNameFor(model => model.Descripcion)</a>
            </th>
            <th>
                <a style="color: white;">@Html.DisplayNameFor(model => model.Autor)</a>
            </th>
            <th>
                <a style="color: white;">@Html.DisplayNameFor(model => model.Genero)</a>
            </th>
            <th>
                <a style="color: white;">@Html.DisplayNameFor(model => model.Editorial)</a>
            </th>
            <th></th>
            <th></th>
            <th></th>
        </tr>
    </thead>
    <tbody>

@foreach (var item in Model) {
        <tr>
            @* <td>
                <a style="color: white;">@Html.DisplayFor(modelItem => item.ISBN) </a>
            </td> *@
            <td>
                @* @Html.DisplayFor(modelItem => item.Portada) *@
                <img src="~/Images/@item.Portada" class="rounded-circle" width="40" height="40" asp-append-version="true">
            </td>
            <td>
                <a style="color: white;">@Html.DisplayFor(modelItem => item.Titulo)</a>
            </td>
            @* <td>
                <a style="color: white;">@Html.DisplayFor(modelItem => item.Contenido)</a>
            </td> *@
            <td>
                <a style="color: white;">@Html.DisplayFor(modelItem => item.Descripcion)</a>
            </td>
            <td>
                <a style="color: white;">@Html.DisplayFor(modelItem => item.Autor.Nombre)</a>
            </td>
            <td>
                <a style="color: white;">@Html.DisplayFor(modelItem => item.Genero.Nombre)</a>
            </td>
            <td>
                <a style="color: white;">@Html.DisplayFor(modelItem => item.Editorial.Nombre)</a>
            </td>
            @if(User.IsInRole("Administrador")){
                @if(item.Contenido == null){ 
                    
                    @*ESTO ESTA PARA AGREGAR CAPITULOS*@
                    @if(!item.EstadoCompleto){
                        <td>
                            <a class="btn btn-danger btn-sm" asp-action="Create" asp-controller="Capitulo" asp-route-id="@item.Id">Agregar Capitulo</a>
                        </td>
                    }else{
                        <td></td>
                    }
                    <td >
                        <a class="btn btn-warning btn-sm" asp-action="EditConCapitulos" asp-route-id="@item.Id">Modificar</a> 
                    </td>   
                }else{
                    <td></td>
                    <td >
                        <a class="btn btn-warning btn-sm" asp-action="Edit" asp-route-id="@item.Id">Modificar</a> 
                    </td>
                }

                <td>
                @if(item.TieneTrailer()) // si tiene trailer lo tiene q poder fletear
                {
                    <a class="btn btn-secondary btn-sm" asp-action="Delete" asp-controller="Trailer" asp-route-id="@item.Id">Eliminar Trailer</a> 
                }
                else 
                {
                    <a class="btn btn-secondary btn-sm" asp-action="Create" asp-controller="Trailer" asp-route-id="@item.Id">Agregar Trailer</a>
                }
                </td>

                //fletar el libro
                <td><a class="btn btn-outline-danger btn-sm" asp-action="Delete" asp-controller="Libro" asp-route-id="@item.Id">Eliminar Libro</a></td>
            }
        </tr>
}
    </tbody>
</table>
@if(Model.Count() == 0){
    <div class="alert alert-danger" role="alert">
        Â¡No se encontraron libros! 
    </div>
}else if(Model.Count() > 3){
    <button class="ir-arriba btn btn-dark btn-sm btn-block" type="button">Volver arriba</button>
}